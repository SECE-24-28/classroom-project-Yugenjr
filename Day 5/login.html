<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="relative min-h-screen font-sans"
  style="background-image: url('https://i.pinimg.com/736x/50/d9/6e/50d96e0b385bb94ead0cf650ecdde6cd.jpg'); background-size: cover; background-position: center; color:#F1F1F1;">

  <!-- Overlay -->
  <div class="absolute inset-0 bg-gradient-to-br from-black/80 via-black/60 to-black/80"></div>

  <!-- Content -->
  <div class="relative z-10 flex flex-col items-center justify-center min-h-screen px-6">
    <!-- Login Card -->
    <div class="bg-white/10 backdrop-blur-md p-8 rounded-xl shadow-2xl w-full max-w-md text-center space-y-6">
      <h1 class="text-4xl font-extrabold animate-pulse bg-gradient-to-r from-[#FF6B6B] to-[#FFD93D] bg-clip-text text-transparent">
        Login
      </h1>

      <input id="emailInput" type="email" placeholder="Email"
             class="w-full px-4 py-2 rounded-lg bg-white/20 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-[#FFD93D]" />
      <input id="passwordInput" type="password" placeholder="Password"
             class="w-full px-4 py-2 rounded-lg bg-white/20 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-[#FFD93D]" />

      <button id="loginBtn" type="button"
              class="w-full py-2 rounded-full bg-gradient-to-r from-[#FF6B6B] to-[#FFD93D] text-white font-semibold hover:scale-105 transition transform shadow-lg">
        Login
      </button>

      <p id="loginMessage" class="text-sm text-gray-300 mt-2">
        Don't have an account? <a href="signup.html" class="text-[#FFD93D] hover:underline">Sign Up</a> first!
      </p>
    </div>
  </div>

  <!-- JS Logic -->
  <script>
    const loginBtn = document.getElementById('loginBtn');
    const emailInput = document.getElementById('emailInput');
    const passwordInput = document.getElementById('passwordInput');
    const loginMessage = document.getElementById('loginMessage');

    // Show message from signup redirect (if any)
    try {
      const redirectMsg = localStorage.getItem("signupRedirectMessage");
      if (redirectMsg) {
        loginMessage.textContent = redirectMsg;
        loginMessage.className = "text-sm mt-2 text-yellow-400";
        localStorage.removeItem("signupRedirectMessage");
      }
    } catch (_) {}

    function safeGetUsers() {
      try {
        const raw = localStorage.getItem('users');
        return raw ? JSON.parse(raw) : {};
      } catch (_) {
        return {};
      }
    }

    function normalizeEmail(e) {
      return (e || '').trim().toLowerCase();
    }

    function setMessage(text, cls) {
      loginMessage.textContent = text;
      loginMessage.className = 'text-sm mt-2 ' + cls;
    }

    loginBtn.addEventListener('click', () => {
      const email = normalizeEmail(emailInput.value);
      const password = (passwordInput.value || '').trim();

      if (!email || !password) {
        setMessage('Please enter both email and password.', 'text-red-400');
        return;
      }

      const users = safeGetUsers();
      // Support both exact key and case-insensitive match
      let user = users[email];
      if (!user) {
        // Try to find by case-insensitive scan (in case signup stored mixed-case key)
        const key = Object.keys(users).find(k => k.toLowerCase() === email);
        if (key) user = users[key];
      }

      if (!user) {
        // Not signed up → go to signup
        window.location.href = 'signup.html';
        return;
      }

      const savedPassword = (user.password ?? '').toString();
      if (savedPassword !== password) {
        setMessage('Incorrect password. Try again.', 'text-red-400');
        return;
      }

      localStorage.setItem('currentUser', user.email || email);
      setMessage('Login successful! Redirecting…', 'text-green-400');

      setTimeout(() => {
        window.location.href = 'dashboard.html';
      }, 600);
    });

    // Enter key support
    [emailInput, passwordInput].forEach(el => {
      el.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') loginBtn.click();
      });
    });
  </script>
</body>
</html>
